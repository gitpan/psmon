############################################################
# $Id: psmon.conf,v 1.7 2005/04/13 21:57:15 nicolaw Exp $
# psmon.conf - Example psmon Configuration File
# Copyright: (c)2002,2003,2004 Nicola Worthington. All rights reserved.
############################################################
# This file is part of psmon.
#
# psmon is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# psmon is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with psmon; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
############################################################

#
# Please read through this configuration file in detail. It
# will NOT function right out of the box without any
# modifications. This is for good reason, since I don't want
# to receive snotty emails from you or your system
# administrator, being accused of killing your server or
# workstation.
#
# There is further documentation supplied with the psmon
# software. I suggest that you read it thoroughly.
#
#                       - The author, Nicola Worthington
#



# Defines the email address where notification emails should be sent
# to. Defaults to root@localhost.
#
# Please change this to your own email address. I will not be too
# appreciative of receiving notifications about your quake server
# and eggdrops not running!!
# AdminEmail	nicolaworthington@msn.com

# Defines the IP address or hostname of the SMTP server to used to
# send email notifications. Defaults to localhost
# SmtpHost	localhost

# Defines the frequency of process table queries. Defaults to 60 seconds.
Frequency	90

# When defined, psmon will never attempt to kill a process ID which
# is numerically less than or equal to the value defined by last
# safepid. It should be noted that psmon will never attempt to kill a
# process ID less than or equal to 1, or itself. Defaults to 100.
LastSafePID	800

# Accepts a boolean value of On or Off. Surpresses all notifications
# from of preserved process IDs when used in conjunction with the
# lastsafepid directive. Defaults to Off.
ProtectSafePIDsQuietly	Off

# Forces this psmon to as if the --dryrun command line switch had
# specified. This is useful if you want to force a specific
# configuration file to only report and never actually take any
# automated action.
#
# This is enabled in this default distribution configuration in
# order to prevent people from blindly executing psmon "out of the
# box" and causing damage in live environments. Yes, such stupid
# people do really exist!
DryRun		True



# The <Process *> scope is commented out by default. It should
# be used with *EXTREME* care. If you do decide to use it, may I
# suggest that you run psmon in 'DryRun' mode by adding the
# 'DryRun' directive in this configuration file. READ THE
# DOCUMENTATION THOROUGHLY BEFORE ENABLING THIS FEATURE!!!

#<Process *>
#	PctCpu		80
#	PctMem		50
#</Process>



# I have included a set of commonly required processes. They
# are all vital services which must be running on all of my
# workstations and servers. It's a pretty good guess you'll
# want them to always be running too.

# Secure Shell Daemon
<Process sshd>
	LogLevel	LOG_CRITICAL
	SpawnCmd	/sbin/service sshd restart
	PidFile		/var/run/sshd.pid
	# Instances	30
	# PctCPU	90
</Process>

# Cron Daemon
<Process crond>
	spawncmd	/sbin/service crond restart
	pidfile		/var/run/crond.pid
</Process>

# System Logger Daemon
<Process syslogd>
	spawncmd	/sbin/service syslog restart
	pidfile		/var/run/syslogd.pid
</Process>

# Internet Super Daemon
<Process xinetd>
	spawncmd	/sbin/service xinetd restart
	pidfile		/var/run/xinetd.pid
</Process>

# Remote WHO Daemon
<Process rwhod>
	# rwhod is *EVIL*! There is almost never any real
	# reason why you would ever want to run such pants!
	killcmd		/sbin/service rwhod stop
	ttl		1
</Process>

# BIND DNS Daemon
#<Process named>
#	spawncmd	/sbin/service named start
#	pidfile		/var/run/named.pid
#</Process>

# Exim SMTP Mail Daemon
#<Process exim>
#	spawncmd	/sbin/service exim restart
#	pidfile		/var/run/exim.pid
#	# instamces	30
#	# pctcpu	90
#</Process>

# Sendmail SMTP Mail Daemon
#<Process sendmail>
#	spawncmd	/sbin/service sendmail start
#	pidfile		/var/run/sendmail.pid
#</Process>

# Samba SMB File Sharing Daemon
#<Process smbd>
#	spawncmd	/sbin/service smbd restart
#	pidfile		/var/run/samba/smbd.pid
#</Process>
#<Process nmbd>
#	spawncmd	/sbin/service smbd restart
#	pidfile		/var/run/samba/nmbd.pid
#</Process>

# Quallcomm QPopper POP3 Daemon
#<Process popper>
#	spawncmd	/sbin/service popper restart
#	pidfile		/var/run/popper.pid
#</Process>

# Apache Group HTTP Daemon
#<Process httpd>
#	spawncmd	/sbin/service httpd restart
#	pidfile		/var/run/httpd.pid
#	# instances	200
#	# pctcpu	80
#</Process>

# MySQL Database
#<Process mysqld>
#	spawncmd	/sbin/service mysqld restart
#	killcmd		/sbin/service mysqld stop
#	pidfile		/var/run/mysqld/mysqld.pid
#	# pctcpu	90
#	# pctmem	60
#</Process>

# NTP Time Daemon
#<Process ntpd>
#	spawncmd	/sbin/service ntpd restart
#</Process>

# SMNP Daemon
#<Process snmpd>
#
#</Process>

# ProFTPD FTP Daemon
#<Process proftpd>
#	spawncmd	/sbin/service proftpd restart
#	pidfile		/var/run/proftpd.pid
#</Processes>

# wu-ftpd Daemon
# In RedHat 8.0 (which is what I am developing psmon under),
# wu-ftpd is spawned from xinetd on demand, and so may not
# always be running. I have only put this comment in because
# people have asked me why there isn't an example for wu-ftpd
# in the distribution psmon.conf. -- Now you know. ;-)



# These are processes which run frequently on my machines, but
# I have had experience of either running for too long (for
# whatever readon), or spawning too many copies.

# The following is a quick table for your ease of reference:
#      Seconds     Minutes     Hours     Days     Weeks
#           60           1
#         3600          60         1
#        43200         720        12        0.5
#        86400        1440        24        1
#       604800       10080       168        7         1

# Kill excessive of slothenly rsync processes
<Process rsync>
	ttl		43200
	instances	5
</Process>

# Kill excessive of slothenly updatedb processes
<Process updatedb>
	ttl		43200
	instances	2
</Process>

# Kill excessive of slothenly find processes
<Process find>
	ttl		86400
	instances	30
</Process>



# Remove this line to activate this configuration file.
Disabled	True

# PLEASE READ THE DOCUMENTATION BEFORE USING PSMON!!!!!
# You can do so by typing "man psmon", or "perldoc /sbin/psmon"



### the end


